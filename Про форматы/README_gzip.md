## Сжатие данных в gzip

Это способ уменьшить объем файлов или передаваемой информации, чтобы сэкономить место на диске и/или ускорить передачу по сети.

**Когда сжимать данные в gzip?**

-При сохранении файлов CSV, JSON, XML, лог-файлы, дампы БД и др., если они занимают много места. Эти файлы не предполагается часто редактировать. 
Их нужно архивировать или передавать дальше (например, в хранилище, на S3).

-В ETL-процессах и пайплайнах. Если выгружаю данные в промежуточные файлы (CSV/JSON → GZIP). Отправляю файлы по FTP/SFTP/email/API.
Храню staging-данные в хранилищах (например, data lake, S3, HDFS). GZIP удобен тем, что он читается построчно (стриминг), что хорошо для pandas, Spark, Dask, Airflow.

**Когда не надо сжимать данные в gzip?**

-Часто изменяемые файлы, т.к GZIP — не "редактируемый" формат. Чтобы изменить файл, его нужно распаковать и переписать заново.

-Если уже сжатые форматы.

-Если важна скорость чтения. GZIP уменьшает объем, но увеличивает CPU-нагрузку на распаковку. Иногда проще не сжимать (особенно при частом доступе).

**Какие типы данных сжимают чаще всего?**

| Тип данных     | Сжимать? | Комментарий                                     |
| -------------- | -------- | ----------------------------------------------- |
| CSV / TSV      | ✅        | Отлично сжимаются, особенно с повторами         |
| JSON / NDJSON  | ✅        | Часто встречается в логах и API                 |
| XML            | ✅        | Как правило, сильно избыточен по размеру        |
| Parquet / ORC  | ❌        | Уже сжат (внутри может быть Snappy, ZSTD и др.) |
| Бинарные файлы | ❌        | Часто не дают выигрыша                          |
| Логи           | ✅        | Особенно для хранения на диск или в облако      |
| SQL-дампы      | ✅        | Текстовые — хорошо сжимаются                    |


**Staging-данные** (или staging layer, стейджинг-слой) — это данные, которые временно хранятся на промежуточном слое перед загрузкой в основное хранилище данных (data warehouse или data lake). 
Обычно это таблицы с "сырыми" (raw) данными. Структура может совпадать с исходным источником.

**Физически staging хранится в:**

-Базе данных, это отдельная схема или таблицы: staging.orders_raw

-Файловые системы / S3 / HDFS. Папки вроде s3://mybucket/staging/sales/2024-06-01.json.gz

-Data Lake, слой bronze — эквивалент staging в архитектуре Data Lakehouse (например, в Delta Lake).
