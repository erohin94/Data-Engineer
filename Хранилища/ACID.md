**Транзакции** в контексте баз данных — это набор операций, выполняемых как единое целое. 

Транзакция гарантирует, что все операции в её составе будут выполнены полностью и корректно или не будут выполнены вовсе. 

Транзакции обеспечивают целостность данных и помогают избежать ситуаций, когда данные остаются в непоследовательном состоянии из-за сбоев или ошибок.

![image](https://github.com/user-attachments/assets/14ad37ec-b8b2-49c6-96d5-5cc02bb1fb06)

---------------------------------------------------------

Представим себе ситуацию, когда переводите деньги с одного банковского счета на другой. Эта операция может быть представлена как транзакция, состоящая из следующих шагов:

- Уменьшение суммы на одном счете.

 - Увеличение суммы на другом счете.

Если один из этих шагов не удастся (например, из-за технической ошибки), вся транзакция должна быть отменена, чтобы не произошло некорректное изменение баланса на счетах. 

---------------------------------------------------------

**Что делать, если база данных не поддерживает транзакции?**

Если у БД нет транзакций, то мы ее и выбирать не будем, но это не так. Транзакции не являются чем-то важным и супер необходимым.

Если транзакции "из коробки" не доступны, можно либо:

- отслеживать состояние базы данных вручную

- использовать сторонние инструменты для управления транзакциями (например Kafka)

---------------------------------------------------------

**Какие БД поддерживают транзакции?**

MySQL: Поддержка транзакций доступна в таблицах, использующих механизм хранения InnoDB.

PostgreSQL: Полная поддержка транзакций, включая сложные транзакции и вложенные транзакции.

MongoDB: Поддержка транзакций на уровне нескольких документов начиная с версии 4.0. 

И многие другие.

Транзакция - это вставка данных в таблицу, которая всегда должна закончиться либо успехом, либо неудачей, но без изменения данных в БД.

---------------------------------------------------------

**Какие еще свойства должна соблюдать транзакция?**

**ACID** — это акроним, описывающий четыре ключевых свойства транзакций в системах управления базами данных (СУБД). 

Эти свойства обеспечивают надёжность транзакций и целостность данных в базе данных, даже в случае сбоев, ошибок или других непредвиденных ситуаций. 

Вот они слева направо - Атомарность (Atomicity), Согласованность (Consistency), Изолированность (Isolation), Долговечность (Durability).

**1. Атомарность (Atomicity)**

Атомарность гарантирует, что все операции в транзакции будут выполнены полностью или не будут выполнены вовсе. 

Если какая-либо часть транзакции не удается, все изменения отменяются, и база данных возвращается в исходное состояние.

Отправляете деньги с одного банковского счёта на другой. Транзакция включает два шага:

Списать деньги с одного счёта.

Зачислить деньги на другой счёт.

Если первый шаг выполнен успешно, но второй шаг не удался из-за сбоя, деньги не должны исчезнуть. 

Атомарность гарантирует, что либо оба шага будут выполнены (деньги будут переведены), либо ни один из них (деньги останутся на исходном счёте).

Зачем это нужно? Атомарность защищает от частично выполненных транзакций, которые могут привести к некорректному состоянию данных.

**2. Согласованность (Consistency)**

Согласованность гарантирует, что после завершения транзакции база данных остаётся в согласованном состоянии. Это значит, что все правила, ограничения и целостность данных будут соблюдены.

Допустим, у есть правило в базе данных, что сумма всех денег на счетах не может изменяться. Если вы переводите деньги с одного счёта на другой, общая сумма должна остаться неизменной.

Согласованность гарантирует, что транзакция не нарушит это правило: сумма на одном счёте уменьшится, а на другом увеличится ровно на ту же сумму.

Зачем это нужно? Согласованность обеспечивает, что транзакции не приведут к нарушению целостности и правил базы данных, что важно для корректного функционирования системы.

**3. Изолированность (Isolation)**

Изолированность гарантирует, что параллельно выполняемые транзакции не будут влиять друг на друга. Каждая транзакция выполняется так, как будто она единственная в системе.

Два человека одновременно пытаются купить последний билет на концерт. Без изолированности могло бы произойти, что оба видят доступный билет, оба пытаются его купить, и система продаст один билет дважды.

Изолированность гарантирует, что одна из транзакций будет завершена первой (человек успешно купит билет), а вторая транзакция либо увидит, что билетов больше нет, либо будет обработана позже.

Зачем это нужно? Изолированность предотвращает конфликты и ошибки, которые могут возникнуть при параллельной работе с одними и теми же данными.

**4. Долговечность (Durability)**

Долговечность гарантирует, что после успешного завершения транзакции её результаты сохранятся в базе данных и не будут потеряны, даже в случае сбоя системы.

После успешной оплаты (транзакция завершена) ваша покупка зафиксирована, и подтверждение получено.

То есть, после завершения оплаты, система зафиксирует вашу покупку, и вы получите подтверждение об успешной транзакции.

Зачем это нужно? Долговечность обеспечивает сохранение результатов транзакции, что особенно важно для критически важных операций, таких как банковские переводы или покупки.
















