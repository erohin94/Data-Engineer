=====================================================================
Пример: создание таблицы и загрузка данных из CSV в PostgreSQL (Docker)
=====================================================================

   ⚠ Важно понимать:
   COPY ... FROM 'path' выполняется **на стороне PostgreSQL-сервера**,
   а сервер находится **внутри Docker-контейнера**, а НЕ на Windows.

   Поэтому путь к файлу должен существовать внутри контейнера PostgreSQL.

   ---------------------------------------------------------------------
   ШАГ 1. Подготовка локальной папки с файлом
   ---------------------------------------------------------------------
   На Windows создайте папку:

       C:\Users\erohi\Desktop\spark_data_mart\notebooks\data

   Поместите туда CSV-файл:

       costs_postgres.csv

   Итоговый путь на хосте:
       C:\Users\erohi\Desktop\spark_data_mart\notebooks\data\costs_postgres.csv


   ---------------------------------------------------------------------
   ШАГ 2. Прописать volume в docker-compose.yml
   ---------------------------------------------------------------------
   В сервис postgres добавьте:

       volumes:
         - ./notebooks/data:/data

   Теперь папка notebooks/data → смонтирована как /data в контейнере.


   ---------------------------------------------------------------------
   ШАГ 3. Пересоздать контейнер PostgreSQL
   ---------------------------------------------------------------------
   После изменения volume обязательно пересоздайте контейнер:

       docker compose down
       docker compose up -d


   ---------------------------------------------------------------------
   ШАГ 4. Проверить наличие файла внутри контейнера
   ---------------------------------------------------------------------

       docker exec -it postgres bash
       ls /data

   Ожидаемый вывод:
       costs_postgres.csv


   ---------------------------------------------------------------------
   ШАГ 5. Импорт файла в PostgreSQL
   ---------------------------------------------------------------------
   Используем путь внутри контейнера:

       /data/costs_postgres.csv

   =====================================================================
*/


/* Создание таблицы (если отсутствует) */
CREATE TABLE IF NOT EXISTS costs_test (
    date        date,
    campaign_id int,
    costs       float,
    clicks      int,
    views       int
);


/* Загрузка данных из CSV, который доступен внутри контейнера по пути /data */
COPY costs_test
FROM '/data/costs_postgres.csv'
DELIMITER ','
CSV HEADER;


/* Проверка результата */
SELECT * FROM costs_test;
