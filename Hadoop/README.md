# Про HDFS


**Архитектура Hadoop Distributed File System (HDFS)**

Архитектура Hadoop Distributed File System (HDFS) состоит из нескольких ключевых компонентов, которые работают вместе для обеспечения распределенного хранения и обработки данных. Вот основные компоненты и принципы архитектуры HDFS:

1. NameNode (узел имени):

NameNode является главным узлом метаданных в HDFS.

Он хранит информацию о том, где расположены блоки данных в файловой системе, и о состоянии файлов и каталогов.

NameNode также отслеживает работу DataNode и координирует операции записи, чтения и удаления файлов.

Вся метаинформация о файлах и блоках данных хранится в оперативной памяти NameNode и, поэтому, она должна быть достаточно емкой для обработки больших объемов данных.

2. DataNode (узел данных):

DataNode представляет собой узел хранения фактических блоков данных.

Он хранит блоки данных на локальных дисках и отвечает за чтение и запись данных по запросу NameNode и клиентов.

DataNode периодически отправляет отчеты о своем состоянии NameNode, сообщая ему о доступности блоков данных.

3. Secondary NameNode (вторичный узел имени):

Secondary NameNode предназначен для обслуживания NameNode и выполнения операций по резервному копированию и слиянию журналов транзакций.

Вторичный узел имени не является резервным узлом для NameNode. Он просто помогает восстановлению системы после сбоев и выполняет процедуры слияния и архивирования, чтобы уменьшить время восстановления в случае необходимости.

4. Client (клиент):
   
Клиенты представляют собой приложения, которые используют HDFS для чтения, записи и обработки данных.

Клиенты отправляют запросы на операции файловой системы (например, чтение файла) к NameNode и затем взаимодействуют с DataNode для фактического доступа к данным.

5. Block (блок):
   
Данные в HDFS разделены на блоки фиксированного размера (обычно 64 МБ по умолчанию).

Блоки данных реплицируются на разные узлы данных для обеспечения отказоустойчивости и достижения высокой доступности данных.

![image](https://github.com/user-attachments/assets/fbe87fd5-279f-4a2e-b8e8-cd7da6e61f89)

![image](https://github.com/user-attachments/assets/9c567b64-dea2-464f-98c2-483baf6019aa)

**Простыми словами:**

NameNode напрямую к DataNode никогда не обращается, все идет через ClientNode.

![image](https://github.com/user-attachments/assets/55531b6c-3d1a-4358-bd7d-98b36b4b1802)

*На клиентской ноде хотим прочитать файл.*

Обращаемся к NameNode. 

NameNode смотрит в свой справочник и отдает адреса для всех реплик сразу, то есть говорит на на первой DataNode, второй DataNode, третьей DataNode такие то блоки от такого то файла которые тебе нужны. Вот держи апишник "шкафчика-стойки-сервака".

ClientNode после того как получила список идет к DataNode и забирает данные с дисков.

![image](https://github.com/user-attachments/assets/62ad90fb-391b-4a44-b0b5-f88db2233f55)

*Запись происходит немного по другому*

Обращаемся к NameNode. Говорим хотим записать файлик размером гигабайт, фактор репликации такой то, размер блока такой то. Приходим на NameNode. NameNode смотрит где есть оптимально близкое расположение к ClientNode, чтобы не писать в соседний город в Дата Центр, ищет место максимально близкое с ClientNode, например соседний сервер. NameNode расчитывает и выдает список адресов куда можно записать блок. ClientNode получает эту инфу(метаданные) и дальше записывает только первую реплику блока. Первую реплику записали, далее ClientNode идет в NameNode и говорит что все ок. Далее DataNode сами реплицируют все оставшиеся блоки и отсылают всю инфу в NameNode через ClientNode.

![image](https://github.com/user-attachments/assets/5d554057-59b3-4cc0-8f6a-2a2eaaa8376a)

В профессиональном сообществе часто используют термин «узел», или нода (от англ. node — «узел»). Эти понятия идентичны и обозначают серверный компьютер с вычислительной мощностью, которую можно использовать для выполнения полезной работы.

Много узлов — нод, компьютеров — можно связать в сеть, которую называют кластер.

Классический кластер в дата-центре выглядит как высокая стойка с большим количеством серверных компьютеров — узлов.

Кластер намного мощнее одиночного компьютера. Соответственно, может выполнять более сложные задачи, например обрабатывать массивы информации и файлы, которые не помещаются в оперативную память одиночного компьютера.

В кластере (группе компьютеров, соединённых в единую сеть), на котором выполняются вычисления, есть два вида узлов, то есть серверов, компьютеров:

Главный узел, который также называют master node или master.

Рабочий узел, он же worker node, или просто worker.
