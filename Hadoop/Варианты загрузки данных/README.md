## Snapshot vs Increment –≤ –¥–∞–Ω–Ω—ã—Ö

–î–≤–∞ –ø–æ–¥—Ö–æ–¥–∞ –∫ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö –≤ –≤–∏—Ç—Ä–∏–Ω—ã

--------------------------------------------------------------------------
**Snapshot ‚Äî —á—Ç–æ —ç—Ç–æ?**

Snapshot (—Å–Ω–∏–º–æ–∫) ‚Äî —ç—Ç–æ –ø–æ–ª–Ω–∞—è –∫–æ–ø–∏—è –¥–∞–Ω–Ω—ã—Ö –∑–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏.

üìå –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:

–ö–∞–∂–¥—ã–π —Ä–∞–∑ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤—Å—è —Ç–∞–±–ª–∏—Ü–∞.

–í—Å—ë, —á—Ç–æ –±—ã–ª–æ –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–µ –Ω–∞ –º–æ–º–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∫–∏, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –≤–∏—Ç—Ä–∏–Ω–µ.

–ù–∏–∫–∞–∫–æ–π –ª–æ–≥–∏–∫–∏ "—á—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å" ‚Äî –ø—Ä–æ—Å—Ç–æ –ø–æ–ª–Ω—ã–π —Å–Ω–∏–º–æ–∫.

üí° –ü—Ä–∏–º–µ—Ä:

```
-- –ó–∞–≥—Ä—É–∂–∞–µ–º –í–°–ï –∑–∞–∫–∞–∑—ã –∑–∞ —Å–µ–≥–æ–¥–Ω—è
INSERT INTO dwh.orders_snapshot
SELECT * FROM staging.orders;
```

üì¶ –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ: –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ —Ç–∞–±–ª–∏—Ü–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∑–∞–∫–∞–∑–æ–≤.

--------------------------------------------------------------------------
**Increment ‚Äî —á—Ç–æ —ç—Ç–æ?**

Increment (–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç) ‚Äî —ç—Ç–æ —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –∏–ª–∏ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∑–∞–≥—Ä—É–∑–∫–æ–π.

üìå –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:

–ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä—ã—Ö –µ—â—ë –Ω–µ—Ç –≤ –≤–∏—Ç—Ä–∏–Ω–µ.

–¢—Ä–µ–±—É–µ—Ç—Å—è –ª–æ–≥–∏–∫–∞: –ø–æ updated_at, id, –∏–ª–∏ —Ö—ç—à—É.

üí° –ü—Ä–∏–º–µ—Ä:

```
-- –ó–∞–≥—Ä—É–∂–∞–µ–º –¢–û–õ–¨–ö–û –Ω–æ–≤—ã–µ –∏–ª–∏ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã
INSERT INTO dwh.orders_incremental
SELECT *
FROM staging.orders
WHERE updated_at > (SELECT MAX(updated_at) FROM dwh.orders_incremental);
```

üì¶ –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ: –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è.
