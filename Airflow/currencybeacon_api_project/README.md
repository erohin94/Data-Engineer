Попробую написать свой Operator и Hook.

Они будут нужны для взаимодействия с внешним API сервисом, хранящим курсы валют. Также буду использовать PostgreOperator для укладки полученных данных в таблицу, которую также будет создавать отдельным таском.

# **Про Hook**

В Airflow, **hook** — это объект, который используется для установления подключения и взаимодействия с внешними системами, такими как базы данных, облачные хранилища, API и другие сервисы. Хуки предоставляют интерфейсы для выполнения операций с этими системами, абстрагируя детали подключения и взаимодействия. Они помогают упростить доступ к данным и поддерживать безопасность, так как многие параметры подключения можно задать в одном месте.

**Примеры хуков в Airflow:**

`PostgresHook`: Используется для подключения и выполнения операций с базами данных PostgreSQL. Например, вы можете подключаться к базе данных, выполнять SQL-запросы и управлять транзакциями.

`HttpHook`: Используется для взаимодействия с внешними API через HTTP-запросы.

`S3Hook`: Используется для взаимодействия с хранилищем S3 в AWS. Вы можете загружать и скачивать файлы, создавать бакеты и другие операции.

**Как работают хуки:**

**Соединение:** Хуки получают данные подключения (логин, пароль, хост, порт и т.д.) из настроек соединений Airflow (в Admin -> Connections), для доступа к базам данных, API или другим системам.

**Методы:** Каждый хук предоставляет набор методов для выполнения операций с внешними системами, например, get_conn(), run() и другие. Например, для взаимодействия с базой данных можно использовать методы для выполнения SQL-запросов, загрузки данных и т.д.

**Повторное использование:** Хуки позволяют создавать общие логики взаимодействия с внешними системами, которые можно повторно использовать в различных тасках.



