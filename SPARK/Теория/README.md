# –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Spark](#–ö–ª—é—á–µ–≤—ã–µ-–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-Spark)
- [–ö–∞–∫ –∏–º–µ–Ω–Ω–æ Spark —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ø–∞–º—è—Ç–∏](#–ö–∞–∫-–∏–º–µ–Ω–Ω–æ-Spark-—Ä–∞–±–æ—Ç–∞–µ—Ç-–≤-–ø–∞–º—è—Ç–∏)
- [–ö–ª—é—á–µ–≤–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ –º–µ–∂–¥—É Spark –∏ Hadoop MapReduce](#–ö–ª—é—á–µ–≤–æ–µ-—Ä–∞–∑–ª–∏—á–∏–µ-–º–µ–∂–¥—É-Spark-–∏-Hadoop-MapReduce)
- [–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã Spark](#–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã-Spark)
- [–û—Å–Ω–æ–≤–Ω—ã–µ —è–¥—Ä–∞ Spark](#–û—Å–Ω–æ–≤–Ω—ã–µ-—è–¥—Ä–∞-Spark)
- [–°–æ–∑–¥–∞–Ω–∏–µ Spark Session –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–æ Spark Context](#–°–æ–∑–¥–∞–Ω–∏–µ-Spark-Session-–∏-—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ-—Å–æ-Spark-Context)
- [–†–∞–∑–ª–∏—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Spark Session](#–†–∞–∑–ª–∏—á–Ω—ã–µ-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã-Spark-Session)
- [–ö–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –≤ PySpark](#–ö–∞–∫-–ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç-–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ-–∑–∞–¥–∞—á–∏-–≤-PySpark)
- [Workflow –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Spark](#Workflow-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è-Spark)
- [RDD vs Dataset vs Dataframe](#RDD-vs-Dataset-vs-Dataframe)
- [–õ–µ–Ω–∏–≤—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è](#–õ–µ–Ω–∏–≤—ã–µ-–≤—ã—á–∏—Å–ª–µ–Ω–∏—è-–¥–µ–π—Å—Ç–≤–∏—è-–∏-–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è)
- [–§–æ—Ä–º–∞—Ç—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö](#–§–æ—Ä–º–∞—Ç—ã-—Ö—Ä–∞–Ω–µ–Ω–∏—è-–¥–∞–Ω–Ω—ã—Ö)
     
## –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Spark

Spark –∏–º–µ–µ—Ç —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –ø–∞–º—è—Ç–∏, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö. 
–≠—Ç–æ —Å—Ç–∞–ª–æ –≤–æ–∑–º–æ–∂–Ω—ã–º –±–ª–∞–≥–æ–¥–∞—Ä—è –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ `Resilient Distributed Dataset (RDD)`, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ –Ω–∏–º–∏ –≤ –ø–∞–º—è—Ç–∏.

**"–†–∞–±–æ—Ç–∞—Ç—å –≤ –ø–∞–º—è—Ç–∏" (In-Memory Processing)** –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ Spark —Å—Ç–∞—Ä–∞–µ—Ç—Å—è —Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –Ω–µ –Ω–∞ –∂–µ—Å—Ç–∫–æ–º –¥–∏—Å–∫–µ `(HDD)` –∏–ª–∏ `SSD`, 
–∞ –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ `(RAM)` –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤, –≤—Ö–æ–¥—è—â–∏—Ö –≤ –∫–ª–∞—Å—Ç–µ—Ä.

**–ü—Ä–æ—Å—Ç–∞—è –∞–Ω–∞–ª–æ–≥–∏—è**

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã –ø–æ–≤–∞—Ä, –≥–æ—Ç–æ–≤—è—â–∏–π —Å–ª–æ–∂–Ω–æ–µ –±–ª—é–¥–æ:

**–†–∞–±–æ—Ç–∞ —Å –¥–∏—Å–∫–æ–º (–∫–∞–∫ –≤ Hadoop MapReduce - –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–∞ –¥–∏—Å–∫–µ):** –í–∞–º –Ω—É–∂–Ω–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑ —Ö–æ–¥–∏—Ç—å –≤ –∫–ª–∞–¥–æ–≤–∫—É (–¥–∏—Å–∫) –∑–∞ –∫–∞–∂–¥—ã–º –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–º, –ø–æ—Ç–æ–º –æ—Ç–Ω–æ—Å–∏—Ç—å —Ç—É–¥–∞ –∂–µ –≥–æ—Ç–æ–≤—ã–π –ø–æ–ª—É—Ñ–∞–±—Ä–∏–∫–∞—Ç, —á—Ç–æ–±—ã –ø–æ—Ç–æ–º —Å–Ω–æ–≤–∞ –ø–æ–π—Ç–∏ –≤ –∫–ª–∞–¥–æ–≤–∫—É –∑–∞ –Ω–∏–º –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞. –≠—Ç–æ –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ –∏–∑-–∑–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö "—Ö–æ–¥–æ–∫".

**–†–∞–±–æ—Ç–∞ –≤ –ø–∞–º—è—Ç–∏ (–∫–∞–∫ –≤ Spark):** –í—ã –∫–ª–∞–¥–µ—Ç–µ –≤—Å–µ –Ω—É–∂–Ω—ã–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã –∏ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä—è–º–æ –Ω–∞ —Å–≤–æ–π —Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª (–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É—é –ø–∞–º—è—Ç—å). –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–Ω–∞—Ä–µ–∑–∫–∞, —Å–º–µ—à–∏–≤–∞–Ω–∏–µ) –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ, —Ç–∞–∫ –∫–∞–∫ –≤—Å—ë –ø–æ–¥ —Ä—É–∫–æ–π. –ù–∞ –¥–∏—Å–∫ –≤—ã –∏–¥–µ—Ç–µ —Ç–æ–ª—å–∫–æ –≤ —Å–∞–º–æ–º –∫–æ–Ω—Ü–µ, —á—Ç–æ–±—ã —É–±—Ä–∞—Ç—å –≥–æ—Ç–æ–≤–æ–µ –±–ª—é–¥–æ –Ω–∞ —Ö—Ä–∞–Ω–µ–Ω–∏–µ.

**–ü–æ—á–µ–º—É —ç—Ç–æ —Ç–∞–∫ –≤–∞–∂–Ω–æ?**

**–°–∫–æ—Ä–æ—Å—Ç—å:** –û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å –Ω–∞ –ø–æ—Ä—è–¥–∫–∏ –±—ã—Å—Ç—Ä–µ–µ –ª—é–±–æ–≥–æ –¥–∏—Å–∫–∞ (–¥–∞–∂–µ `SSD`). –°–∫–æ—Ä–æ—Å—Ç—å –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º –≤ `RAM` –≤ —Å–æ—Ç–Ω–∏ —Ç—ã—Å—è—á —Ä–∞–∑ –≤—ã—à–µ, —á–µ–º –∫ –¥–∞–Ω–Ω—ã–º –Ω–∞ `HDD`. –≠—Ç–æ –≥–ª–∞–≤–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞, –ø–æ –∫–æ—Ç–æ—Ä–æ–π `Spark` –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ 100 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ `Hadoop MapReduce` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á.

**–ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ—Å—Ç—å:** –ú–Ω–æ–≥–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã (–æ—Å–æ–±–µ–Ω–Ω–æ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –∏ –≥—Ä–∞—Ñ–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã) —Ç—Ä–µ–±—É—é—Ç –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ–≥–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è (–∏—Ç–µ—Ä–∞—Ü–∏–π) –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –Ω–∞–¥ –æ–¥–Ω–∏–º–∏ –∏ —Ç–µ–º–∏ –∂–µ –¥–∞–Ω–Ω—ã–º–∏. `Spark` –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –ø–∞–º—è—Ç—å –æ–¥–∏–Ω —Ä–∞–∑ –∏ –º–æ–∂–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è, –Ω–µ –æ–±—Ä–∞—â–∞—è—Å—å –∫ –¥–∏—Å–∫—É —Å–Ω–æ–≤–∞ –∏ —Å–Ω–æ–≤–∞.

**–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** –ë–ª–∞–≥–æ–¥–∞—Ä—è —Å–∫–æ—Ä–æ—Å—Ç–∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω—ã–º –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö. –í—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ –±–æ–ª—å—à–∏–º –¥–∞–Ω–Ω—ã–º –∏ –ø–æ–ª—É—á–∞—Ç—å –æ—Ç–≤–µ—Ç –∑–∞ —Å–µ–∫—É–Ω–¥—ã, –∞ –Ω–µ –º–∏–Ω—É—Ç—ã –∏–ª–∏ —á–∞—Å—ã, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ "–Ω–∞ –ª–µ—Ç—É".

## –ö–∞–∫ –∏–º–µ–Ω–Ω–æ Spark —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ø–∞–º—è—Ç–∏

–í –æ—Å–Ω–æ–≤–µ Spark –ª–µ–∂–∏—Ç –∫–æ–Ω—Ü–µ–ø—Ü–∏—è `RDD (Resilient Distributed Dataset)` ‚Äî —É—Å—Ç–æ–π—á–∏–≤—ã–π —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö.

**1.–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π:** –î–∞–Ω–Ω—ã–µ —Ä–∞–∑–±–∏–≤–∞—é—Ç—Å—è –Ω–∞ —á–∞—Å—Ç–∏ `(partitions)` –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø–æ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ —Ä–∞–∑–Ω—ã—Ö —É–∑–ª–æ–≤ (–∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤) –∫–ª–∞—Å—Ç–µ—Ä–∞.

**2.–£—Å—Ç–æ–π—á–∏–≤—ã–π (Resilient):** `Spark` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç, –∫–∞–∫ –±—ã–ª —Å–æ–∑–¥–∞–Ω –∫–∞–∂–¥—ã–π `RDD` (–µ–≥–æ "—Ä–æ–¥–æ—Å–ª–æ–≤–Ω—É—é" –∏–ª–∏ `lineage`). –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –æ–¥–Ω–æ–º –∏–∑ —É–∑–ª–æ–≤ —Ç–µ—Ä—è—é—Ç—Å—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É–ø–∞–ª —Å–µ—Ä–≤–µ—Ä), `Spark` –º–æ–∂–µ—Ç –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞–Ω–æ–≤–æ –Ω–∞ –¥—Ä—É–≥–∏—Ö —É–∑–ª–∞—Ö, –∏—Å–ø–æ–ª—å–∑—É—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∏—Ö –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–∏. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –∑–∞–ø–∏—Å–∏ –Ω–∞ –º–µ–¥–ª–µ–Ω–Ω—ã–π –¥–∏—Å–∫.

**3.–ù–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –≤ –ø–∞–º—è—Ç–∏:** `RDD` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `RAM`. –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–∞–º—è—Ç–∏ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç, `Spark` "–≤—ã—Ç–µ—Å–Ω—è–µ—Ç" `(spills)` —á–∞—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –¥–∏—Å–∫, –Ω–æ —Å—Ç–∞—Ä–∞–µ—Ç—Å—è –¥–µ–ª–∞—Ç—å —ç—Ç–æ –∫–∞–∫ –º–æ–∂–Ω–æ —Ä–µ–∂–µ.

**–í–∞–∂–Ω–æ–µ —É—Ç–æ—á–Ω–µ–Ω–∏–µ: –ù–µ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤—Å–µ–≥–¥–∞ –≤ –ø–∞–º—è—Ç–∏**

–í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ `Spark` ‚Äî –Ω–µ –≤–æ–ª—à–µ–±–Ω–∞—è –ø–∞–ª–æ—á–∫–∞. –ï—Å—Ç—å –Ω—é–∞–Ω—Å—ã:

**1.–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–Ω–∞—á–∞–ª–∞ —á–∏—Ç–∞—é—Ç—Å—è —Å –¥–∏—Å–∫–∞.** `Spark` –Ω–µ —Å–æ–∑–¥–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –≤–æ–∑–¥—É—Ö–∞. –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ–±—ã—á–Ω–æ –ª–µ–∂–∞—Ç –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `HDFS`) –∏–ª–∏ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. `Spark` —Å–Ω–∞—á–∞–ª–∞ —Å—á–∏—Ç—ã–≤–∞–µ—Ç –∏—Ö —Å –¥–∏—Å–∫–∞ –≤ –ø–∞–º—è—Ç—å.

**2.–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (Caching/Persistence)** ‚Äî —ç—Ç–æ —è–≤–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ. –ß—Ç–æ–±—ã –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞–≤–∞–ª–∏—Å—å –≤ –ø–∞–º—è—Ç–∏ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç –¥–æ–ª–∂–µ–Ω —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å —ç—Ç–æ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–æ–≤ `.cache()` –∏–ª–∏ `.persist()`. –ë–µ–∑ —ç—Ç–æ–≥–æ `Spark` –º–æ–∂–µ—Ç –≤—ã–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø–∞–º—è—Ç–∏ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏.

**3.–ï—Å–ª–∏ –ø–∞–º—è—Ç–∏ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç**, Spark –Ω–∞—á–∏–Ω–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∏—Å–∫, –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ –ø–∞–¥–∞–µ—Ç. –ü–æ—ç—Ç–æ–º—É —Ä–∞–∑–º–µ—Ä –∫–ª–∞—Å—Ç–µ—Ä–∞ –∏ –æ–±—ä–µ–º –ø–∞–º—è—Ç–∏ –Ω—É–∂–Ω–æ –∞–¥–µ–∫–≤–∞—Ç–Ω–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ –∑–∞–¥–∞—á—É.

**–ü—Ä–∏–º–µ—Ä –Ω–∞ –ø—Å–µ–≤–¥–æ–∫–æ–¥–µ**

–î–æ–ø—É—Å—Ç–∏–º, –Ω–∞–º –Ω—É–∂–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ –∏ –Ω–∞–π—Ç–∏ —Å–∞–º–æ–µ —á–∞—Å—Ç–æ–µ —Å–ª–æ–≤–æ.

*–ë–µ–∑ —Ä–∞–±–æ—Ç—ã –≤ –ø–∞–º—è—Ç–∏ (–∫–∞–∫ –≤ —Å—Ç–∞—Ä–æ–º –ø–æ–¥—Ö–æ–¥–µ):*

1.–ü—Ä–æ—á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å –¥–∏—Å–∫–∞ -> –ø–æ—Å—á–∏—Ç–∞—Ç—å —Å–ª–æ–≤–∞ -> –∑–∞–ø–∏—Å–∞—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –¥–∏—Å–∫.

2.–ü—Ä–æ—á–∏—Ç–∞—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å –¥–∏—Å–∫–∞ -> –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É -> –∑–∞–ø–∏—Å–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –¥–∏—Å–∫.

3.–ü—Ä–æ—á–∏—Ç–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å –¥–∏—Å–∫–∞ -> –≤–∑—è—Ç—å –ø–µ—Ä–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ -> –≤—ã–≤–µ—Å—Ç–∏ –æ—Ç–≤–µ—Ç.

*–° Spark –∏ —Ä–∞–±–æ—Ç–æ–π –≤ –ø–∞–º—è—Ç–∏:*

1.–ü—Ä–æ—á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å –¥–∏—Å–∫–∞ –∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤ –ø–∞–º—è—Ç—å.

2.–ü–æ—Å—á–∏—Ç–∞—Ç—å —Å–ª–æ–≤–∞ (—Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—Å—Ç–∞–µ—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏).

3.–û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–æ–ø–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –≤ –ø–∞–º—è—Ç–∏).

4.–í–∑—è—Ç—å –ø–µ—Ä–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –≤—ã–≤–µ—Å—Ç–∏ –æ—Ç–≤–µ—Ç. –ù–∞ –¥–∏—Å–∫ –ø–∏—à–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–Ω–µ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

**–ò—Ç–æ–≥**

"–†–∞–±–æ—Ç–∞—Ç—å –≤ –ø–∞–º—è—Ç–∏" ‚Äî —ç—Ç–æ –æ—Å–Ω–æ–≤–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –∏–¥–µ—è Spark, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –µ–º—É –¥–æ—Å—Ç–∏–≥–∞—Ç—å –≤—ã—Å–æ–∫–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∑–∞ —Å—á–µ—Ç –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞ —Å –¥–∏—Å–∫–æ–º. –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞, —á—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –¥–ª—è –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á.

## –ö–ª—é—á–µ–≤–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ –º–µ–∂–¥—É Spark –∏ Hadoop MapReduce

–ö–ª—é—á–µ–≤–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ –º–µ–∂–¥—É `Spark` –∏ `Hadoop MapReduce` –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –º–æ–¥–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏ –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.

**Hadoop MapReduce: –ñ–µ—Å—Ç–∫–∞—è –º–æ–¥–µ–ª—å "–¥–∏—Å–∫-–ø–∞–º—è—Ç—å-–¥–∏—Å–∫"**

–í MapReduce –∫–∞–∂–¥—ã–π —ç—Ç–∞–ø —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ —Å–ª–µ–¥—É–µ—Ç —Å—Ç—Ä–æ–≥–æ–º—É —à–∞–±–ª–æ–Ω—É:

**1. Read (–ß—Ç–µ–Ω–∏–µ):** –î–∞–Ω–Ω—ã–µ —Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Å –¥–∏—Å–∫–∞ `(HDFS)` –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É—é –ø–∞–º—è—Ç—å.

**2. Map/Reduce (–í—ã—á–∏—Å–ª–µ–Ω–∏—è):** –í –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–∏ `map` –∏–ª–∏ `reduce`.

**3. Write (–ó–∞–ø–∏—Å—å):** –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—ã–≤–æ–¥ —ç—Ç–∞–ø–∞ `map`, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –≤—Ö–æ–¥–æ–º –¥–ª—è —ç—Ç–∞–ø–∞ `reduce`) –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π –¥–∏—Å–∫ –∫–∞–∂–¥–æ–≥–æ `worker`-—É–∑–ª–∞.

**4. Shuffle (–ü–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ):** –°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø (–Ω–∞–ø—Ä–∏–º–µ—Ä, `reduce`) –¥–æ–ª–∂–µ–Ω —Å—á–∏—Ç–∞—Ç—å —ç—Ç–∏ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –¥–∏—Å–∫–æ–≤ –¥—Ä—É–≥–∏—Ö —É–∑–ª–æ–≤ –ø–æ —Å–µ—Ç–∏.

**–ü—Ä–æ–±–ª–µ–º–∞:** –≠—Ç–∞ –º–æ–¥–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –æ–≥—Ä–æ–º–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞ `(I/O)` –Ω–∞ –¥–∏—Å–∫. –î–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π, —Ç—Ä–µ–±—É—é—â–∏—Ö –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö `MapReduce`-–∑–∞–¥–∞—á), —ç—Ç–∏ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ –ø–∏—à—É—Ç—Å—è –∏ —á–∏—Ç–∞—é—Ç—Å—è —Å –¥–∏—Å–∫–∞, —á—Ç–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è "–±—É—Ç—ã–ª–æ—á–Ω—ã–º –≥–æ—Ä–ª—ã—à–∫–æ–º" –∏ —Å–∏–ª—å–Ω–æ –∑–∞–º–µ–¥–ª—è–µ—Ç –≤—Å—é –æ–±—Ä–∞–±–æ—Ç–∫—É.

**Apache Spark: –ì–∏–±–∫–∞—è –º–æ–¥–µ–ª—å "–ø–∞–º—è—Ç—å-–¥–∏—Å–∫-–ø–∞–º—è—Ç—å"**

`Spark` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–æ–ª–µ–µ –≥–∏–±–∫–∏–π –ø–æ–¥—Ö–æ–¥, –æ—Ç–¥–∞–≤–∞—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–∞–º—è—Ç–∏:

**1. Read (–ß—Ç–µ–Ω–∏–µ):** –î–∞–Ω–Ω—ã–µ —Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Å –¥–∏—Å–∫–∞ (`HDFS`, `S3` –∏ —Ç.–¥.) –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É—é –ø–∞–º—è—Ç—å.

**2. Transformations (–í—ã—á–∏—Å–ª–µ–Ω–∏—è):** –ù–∞–¥ –¥–∞–Ω–Ω—ã–º–∏ –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤—Å–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è (`map`, `filter`, `reduce`, `join` –∏ —Ç.–¥.).

**3. Persistence (–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏):** –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–∂–Ω–æ —è–≤–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å (–∑–∞–∫—ç—à–∏—Ä–æ–≤–∞—Ç—å) –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–æ–≤ '.cache()' –∏–ª–∏ '.persist()'. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ—Å–ª–µ–¥—É—é—â–∏–º –æ–ø–µ—Ä–∞—Ü–∏—è–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ —Å –æ–≥—Ä–æ–º–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é, –Ω–µ —á–∏—Ç–∞—è –∏—Ö –∑–∞–Ω–æ–≤–æ —Å –¥–∏—Å–∫–∞.

**4. Shuffle (–ü–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ):** –•–æ—Ç—è `Spark` –∏ —Å—Ç–∞—Ä–∞–µ—Ç—Å—è –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–∏—à–Ω–∏–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è, —ç—Ç–∞–ø `shuffle` –≤—Å—ë –∂–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ–¥ `reduceByKey`). –ù–æ –∫–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ: –¥–∞–∂–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è `shuffle` —Å–Ω–∞—á–∞–ª–∞ —Å—Ç–∞—Ä–∞—é—Ç—Å—è –±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ –ø–∞–º—è—Ç–∏, –∏ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ—Ö–≤–∞—Ç–∫–µ –º–µ—Å—Ç–∞ —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π –¥–∏—Å–∫ —É–∑–ª–∞.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** –ú–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ –æ–¥–Ω–∏–º–∏ –∏ —Ç–µ–º–∏ –∂–µ –¥–∞–Ω–Ω—ã–º–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –≤ –ø–∞–º—è—Ç–∏ –Ω–∞ –ø–æ—Ä—è–¥–æ–∫ –±—ã—Å—Ç—Ä–µ–µ. –î–∏—Å–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —ç–∫–æ–Ω–æ–º–Ω–æ, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤ –∏–ª–∏ –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.

## –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã Spark

**Cloudera Impala:** Impala - —ç—Ç–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π SQL-–¥–≤–∏–∂–æ–∫, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —Ö—Ä–∞–Ω—è—â–∏—Ö—Å—è –≤ Apache Hadoop. 
Impala –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤—ã—Å–æ–∫—É—é —Å–∫–æ—Ä–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è SQL-–∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

## –û—Å–Ω–æ–≤–Ω—ã–µ —è–¥—Ä–∞ Spark

Apache Spark —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö. –û—Å–Ω–æ–≤–Ω—ã–µ —è–¥—Ä–∞ Apache Spark –≤–∫–ª—é—á–∞—é—Ç:

**Spark Core:** Spark Core —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω—ã–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º Apache Spark. 
–û–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ API –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –≤–∫–ª—é—á–∞—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é, –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á, –≤–≤–æ–¥-–≤—ã–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π.

**Spark SQL:** Spark SQL –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—è SQL-–∑–∞–ø—Ä–æ—Å—ã –∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ —Ç–∞–±–ª–∏—Ü—ã, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏ –¥–∞—Ç–∞—Å–µ—Ç—ã. 
Spark SQL –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, –≤–∫–ª—é—á–∞—è Apache Hive, JDBC –∏ –¥—Ä—É–≥–∏–µ.

**Spark Streaming:** Spark Streaming –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—Ç–æ–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. 
–û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ –∏–∑ –æ—á–µ—Ä–µ–¥–µ–π —Å–æ–æ–±—â–µ–Ω–∏–π, —Å–∏—Å—Ç–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —Ç.–¥.

**MLlib:** MLlib (Machine Learning Library) —è–≤–ª—è–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –≤ Apache Spark. 
–û–Ω–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–∞–±–æ—Ä –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∏ —É—Ç–∏–ª–∏—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, —Ä–µ–≥—Ä–µ—Å—Å–∏–∏, –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –∏ –¥—Ä—É–≥–∏—Ö –∑–∞–¥–∞—á –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

**GraphX:** GraphX - —ç—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥—Ä–∞—Ñ–∞–º–∏ –≤ Apache Spark. 
–û–Ω–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç API –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≥—Ä–∞—Ñ–æ–≤—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏, —Å–µ—Ç–∏ —Å–≤—è–∑–µ–π –∏ –¥—Ä—É–≥–∏–µ.

**SparkR:** SparkR - —ç—Ç–æ –ø–∞–∫–µ—Ç –¥–ª—è —è–∑—ã–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è R, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ Apache Spark –≤ —Å—Ä–µ–¥–µ R. 
–û–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç R-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –¥–∞–Ω–Ω—ã–º–∏ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –≤ Spark.

–ö–∞–∂–¥–æ–µ —è–¥—Ä–æ Apache Spark –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Å–≤–æ–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏ API –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö. 
–í–º–µ—Å—Ç–µ —ç—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –º–æ—â–Ω—É—é –∏ –≥–∏–±–∫—É—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á –∞–Ω–∞–ª–∏–∑–∞ –∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

## –°–æ–∑–¥–∞–Ω–∏–µ Spark Session –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–æ Spark Context

–í Apache Spark —Å–æ–∑–¥–∞–Ω–∏–µ `Spark Session` —è–≤–ª—è–µ—Ç—Å—è –±–æ–ª–µ–µ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–º –ø–æ–¥—Ö–æ–¥–æ–º –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `Spark Context`. –í–æ—Ç –ø–æ—á–µ–º—É:

**Spark Context** –±—ã–ª –æ—Å–Ω–æ–≤–Ω–æ–π –≤—Ö–æ–¥–Ω–æ–π —Ç–æ—á–∫–æ–π –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ Spark –≤ –±–æ–ª–µ–µ —Ä–∞–Ω–Ω–∏—Ö –≤–µ—Ä—Å–∏—è—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞. –û–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–ª –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ Spark, —Ç–∞–∫–∏–µ –∫–∞–∫ —Å–æ–∑–¥–∞–Ω–∏–µ `RDD (Resilient Distributed Dataset)` –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞–¥ –Ω–∏–º–∏. –û–¥–Ω–∞–∫–æ, —Å –ø–æ—è–≤–ª–µ–Ω–∏–µ–º Spark 2.0 –∏ –≤—ã—à–µ, –≤–≤–µ–¥–µ–Ω–∏–µ `Spark Session` —Å—Ç–∞–ª–æ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º —Ä–∞–±–æ—Ç—ã —Å Spark.

**Spark Session** —è–≤–ª—è–µ—Ç—Å—è –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º, –∫–æ—Ç–æ—Ä—ã–π –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å `Spark Context`, `SQL Context` –∏ `Hive Context` –≤ –æ–¥–Ω–æ–º –æ–±—ä–µ–∫—Ç–µ. –û–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Ñ—É–Ω–∫—Ü–∏—è–º `Spark Core`, `Spark SQL`, `Spark Streaming`, `MLlib` –∏ `GraphX`. `Spark Session` –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, –≤–∫–ª—é—á–∞—è `RDD`, `DataFrames` –∏ `Datasets`, –∞ —Ç–∞–∫–∂–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —è–∑—ã–∫–µ SQL, –º–∞–Ω–∏–ø—É–ª–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Spark Session –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å Spark Context:**

–£–¥–æ–±—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è: Spark Session –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±–æ–ª–µ–µ —É–¥–æ–±–Ω—ã–π –∏ –µ–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –º–æ–¥—É–ª—è–º–∏ Spark. –û–Ω —É–ø—Ä–æ—â–∞–µ—Ç –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–æ–≤—ã—à–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö: Spark Session –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å RDD, DataFrames –∏ Datasets, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–æ–ª–µ–µ –≥–∏–±–∫—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∏ –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –≤ Spark.

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–æ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏: Spark Session –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ Hive, JDBC, Parquet, Avro –∏ –¥—Ä—É–≥–∏–º–∏.

–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: Spark Session –∏–º–µ–µ—Ç –ª—É—á—à—É—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —É–ª—É—á—à–µ–Ω–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö: Spark Session –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, –≤–∫–ª—é—á–∞—è —Ñ–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã (HDFS, S3 –∏ —Ç.–¥.), –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (MySQL, PostgreSQL –∏ –¥—Ä.), Apache Kafka –∏ –¥—Ä—É–≥–∏–µ.

–í –∏—Ç–æ–≥–µ, Spark Session –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±–æ–ª–µ–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∏ –º–æ—â–Ω—ã–π —Å–ø–æ—Å–æ–± —Ä–∞–±–æ—Ç—ã —Å Apache Spark, –æ–±—ä–µ–¥–∏–Ω—è—è —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–æ–¥—É–ª–∏ –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —É–¥–æ–±—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –≥–∏–±–∫–æ—Å—Ç—å –∏ –ª—É—á—à—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å. –û–Ω —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–º –ø–æ–¥—Ö–æ–¥–æ–º –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ Spark, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞—á–∏–Ω–∞—è —Å –≤–µ—Ä—Å–∏–∏ Spark 2.0 –∏ –≤—ã—à–µ.

**–ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è Spark Context –Ω–∞ Python:**

```
from pyspark import SparkContext

# –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ SparkContext
sc = SparkContext(appName="MySparkApp")

# –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å RDD

# –ó–∞–∫—Ä—ã—Ç–∏–µ SparkContext
sc.stop()
```
                  
**–ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è Spark Session –Ω–∞ Python:**

```
from pyspark.sql import SparkSession

# –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ SparkSession
spark = SparkSession.builder \
    .appName("MySparkApp") \
    .getOrCreate()

# –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å DataFrames
# –ó–∞–∫—Ä—ã—Ç–∏–µ SparkSession
spark.stop()
```
                  
–í –æ–±–æ–∏—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º PySpark –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Spark –≤ —è–∑—ã–∫–µ Python.

–í –ø—Ä–∏–º–µ—Ä–µ —Å–æ–∑–¥–∞–Ω–∏—è `Spark Context` –º—ã –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –º–æ–¥—É–ª—å `SparkContext` –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `PySpark` –∏ —Å–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç `sc` —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∏–º–µ–Ω–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ó–∞—Ç–µ–º –º—ã –º–æ–∂–µ–º –≤—ã–ø–æ–ª–Ω—è—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å `RDD`, –∏—Å–ø–æ–ª—å–∑—É—è `sc`. –ü–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–∑–≤–∞—Ç—å –º–µ—Ç–æ–¥ `stop()` –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è `Spark Context`.

–í –ø—Ä–∏–º–µ—Ä–µ —Å–æ–∑–¥–∞–Ω–∏—è `Spark Session` –º—ã –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –º–æ–¥—É–ª—å `SparkSession` –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º `builder` –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ `Spark Session`, —Ç–∞–∫–∏—Ö –∫–∞–∫ –∏–º—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ó–∞—Ç–µ–º –º—ã –≤—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ `getOrCreate()`, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é `Spark Session` –∏–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é, –µ—Å–ª–∏ –æ–Ω–∞ —É–∂–µ —Å–æ–∑–¥–∞–Ω–∞. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º—ã –º–æ–∂–µ–º –≤—ã–ø–æ–ª–Ω—è—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å `DataFrames`, –∏—Å–ø–æ–ª—å–∑—É—è `spark`. –ù–∞–∫–æ–Ω–µ—Ü, –º—ã –≤—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ `stop()` –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è `Spark Session`.

## –†–∞–∑–ª–∏—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Spark Session

**App Name (spark.app.name)**

- –û–ø–∏—Å–∞–Ω–∏–µ: –ò–º—è Spark-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
- –ü—Ä–∏–º–µ—Ä: spark = SparkSession.builder.appName("MyApp").getOrCreate()

**Master (spark.master)**

- –û–ø–∏—Å–∞–Ω–∏–µ: –£–∫–∞–∑—ã–≤–∞–µ—Ç –∫–ª–∞—Å—Ç–µ—Ä–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–æ–∫–∞–ª—å–Ω–æ –∏–ª–∏ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ).
- –ü—Ä–∏–º–µ—Ä: spark = SparkSession.builder.master("local[*]").getOrCreate()

**Spark SQL Shuffle Partitions (spark.sql.shuffle.partitions)**

- –û–ø–∏—Å–∞–Ω–∏–µ: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑–¥–µ–ª–æ–≤ –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π shuffle –≤ Spark SQL.
- –ü—Ä–∏–º–µ—Ä: spark = SparkSession.builder.config("spark.sql.shuffle.partitions", "200").getOrCreate()

**Executor Memory (spark.executor.memory)**

- –û–ø–∏—Å–∞–Ω–∏–µ: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞–º—è—Ç–∏, –≤—ã–¥–µ–ª—è–µ–º–æ–π –∫–∞–∂–¥–æ–º—É –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é.
- –ü—Ä–∏–º–µ—Ä: spark = SparkSession.builder.config("spark.executor.memory", "4g").getOrCreate()

**Driver Memory (spark.driver.memory)**

- –û–ø–∏—Å–∞–Ω–∏–µ: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞–º—è—Ç–∏, –≤—ã–¥–µ–ª—è–µ–º–æ–π –¥—Ä–∞–π–≤–µ—Ä—É Spark-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
- –ü—Ä–∏–º–µ—Ä: spark = SparkSession.builder.config("spark.driver.memory", "2g").getOrCreate()

**Executor Cores (spark.executor.cores)**

- –û–ø–∏—Å–∞–Ω–∏–µ: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —è–¥–µ—Ä, –≤—ã–¥–µ–ª—è–µ–º—ã—Ö –∫–∞–∂–¥–æ–º—É –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é.
- –ü—Ä–∏–º–µ—Ä: spark = SparkSession.builder.config("spark.executor.cores", "4").getOrCreate()

**Dynamic Allocation (spark.dynamicAllocation.enabled)**

- –û–ø–∏—Å–∞–Ω–∏–µ: –í–∫–ª—é—á–∞–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
- –ü—Ä–∏–º–µ—Ä: spark = SparkSession.builder.config("spark.dynamicAllocation.enabled", "true").getOrCreate()

**Checkpoint Directory (spark.checkpoint.dir)**

- –û–ø–∏—Å–∞–Ω–∏–µ: –£–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö —Ç–æ—á–µ–∫ RDD.
- –ü—Ä–∏–º–µ—Ä: spark = SparkSession.builder.config("spark.checkpoint.dir", "/path/to/checkpoint/dir").getOrCreate()

**SQL Warehouse Directory (spark.sql.warehouse.dir)**

- –û–ø–∏—Å–∞–Ω–∏–µ: –£–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö Spark SQL.
- –ü—Ä–∏–º–µ—Ä: spark = SparkSession.builder.config("spark.sql.warehouse.dir", "/path/to/warehouse/dir").getOrCreate()

**Hive Support (spark.sql.catalogImplementation)**

- –û–ø–∏—Å–∞–Ω–∏–µ: –í–∫–ª—é—á–∞–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É Apache Hive –≤ Spark SQL.
- –ü—Ä–∏–º–µ—Ä: spark = SparkSession.builder.config("spark.sql.catalogImplementation", "hive").enableHiveSupport().getOrCreate()

**–ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è Spark Session —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**

```
from pyspark.sql import SparkSession

# –°–æ–∑–¥–∞–Ω–∏–µ Spark Session —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
spark = SparkSession.builder \
    .appName("MyApp") \
    .master("local[*]") \
    .config("spark.sql.shuffle.partitions", "200") \
    .config("spark.executor.memory", "4g") \
    .config("spark.driver.memory", "2g") \
    .config("spark.executor.cores", "4") \
    .config("spark.dynamicAllocation.enabled", "true") \
    .config("spark.checkpoint.dir", "/path/to/checkpoint/dir") \
    .config("spark.sql.warehouse.dir", "/path/to/warehouse/dir") \
    .config("spark.sql.catalogImplementation", "hive") \
    .enableHiveSupport() \
    .getOrCreate()

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Spark Session
df = spark.read.json("/path/to/json/file")
df.show()
```

## –ö–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –≤ PySpark

–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏ Spark. –ï—Å–ª–∏ Spark Session —ç—Ç–æ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–æ–≥—Ä–∞–º–º—É, —Ç–æ –¥–∞–ª–µ–µ –±—É–¥–µ—Ç –ø–∏—Å–∞—Ç—å—Å—è –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º Spark. –†–∞–∑–±–∏—Ä–µ–º—Å—è, —á—Ç–æ –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å, –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –º—ã –∑–∞–ø—É—Å—Ç–∏–º –ø—Ä–æ–≥—Ä–∞–º–º—É.

–õ—é–±–æ–µ Spark –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥—Ä–∞–π–≤–µ—Ä–∞(driver) –∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π(executors). –ö–∞–∫ —Ä–∞–∑ —Ç–∞–∫–∏ driver - —ç—Ç–æ –∏ –µ—Å—Ç—å –Ω–∞—à–∞ Spark Session. –ò–º–µ–Ω–Ω–æ –≤ –Ω–µ–π, –∑–∞–¥–∞–µ—Ç—Å—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ –Ω–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ. 

–¢–µ–ø–µ—Ä—å —Ä–∞–∑–±–µ—Ä–µ–º—Å—è —Å —ç–∫–∑–µ–∫—å—é—Ç–æ—Ä–∞–º–∏. –≠–∫–∑–µ–∫—å—é—Ç–æ—Ä—ã –Ω—É–∂–Ω—ã –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á Spark. –ü—Ä–∏ —á–µ–º –∑–¥–µ—Å—å –≤–∞–∂–Ω–æ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –æ–¥–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Spark - —ç—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á (–Ω–æ, –∫–æ–Ω–µ—á–Ω–æ –∂–µ, –º–æ–∂–µ—Ç –±—ã—Ç—å –∏ –æ–¥–Ω–∞). –ò–º–µ–Ω–Ω–æ –≤ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è—Ö (—ç–∫–∑–µ–∫—å—é—Ç–æ—Ä–∞—Ö) –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö. –°—Ç–æ–∏—Ç —Ç–∞–∫–∂–µ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —ç–∫–∑–µ–∫—å—é—Ç–æ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –∏ –ø–æ—Ç–æ–º –æ—Ç–¥–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥—Ä–∞–π–≤–µ—Ä—É (—Ç—É—Ç –¥–æ–ª–∂–Ω–∞ –≤—Å–ø–æ–º–Ω–∏—Ç—å—Å—è –ø–æ—Ö–æ–∂–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞ –ø—Ä–æ HDFS, —Ç–æ–ª—å–∫–æ —Ç–∞–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ—Ç—É).

<p align="center"><img width="500" height="490" alt="–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è" src="https://github.com/user-attachments/assets/e54a48db-a099-4efd-95e8-d3b0716afcf2" /></p>

–°–∏—Ç—É–∞—Ü–∏—è –≤—ã—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∞—è - –µ—Å—Ç—å worker node, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–¥–∞—é—Ç—Å—è cluster manager –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏. –ò —É–∂–µ –∏—Å—Ö–æ–¥—è –∏–∑ —ç—Ç–∏—Ö worker node –∏ –¥–æ—Å—Ç—É–ø–Ω–æ–π —Ç–∞–º –ø–∞–º—è—Ç–∏ –º—ã –∑–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Spark. –ù–∞ –æ–¥–Ω–æ–π worker node –º–æ–∂–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ executors, –µ—Å–ª–∏ –±—É–¥–µ—Ç —Ö–≤–∞—Ç–∞—Ç—å —Ä–µ—Å—É—Ä—Å–æ–≤. –ò —Ç–∞–∫–∂–µ –≤ executors –º–æ–∂–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á.


**–ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞ —Ä–µ—Å—É—Ä—Å–æ–≤**

–î–æ–ø—É—Å—Ç–∏–º, —É –Ω–∞—Å –µ—Å—Ç—å worker node —Å 16 —è–¥—Ä–∞–º–∏ –∏ 64 –ì–ë –ø–∞–º—è—Ç–∏. –ï—Å–ª–∏ —É–∫–∞–∂–µ–º, —á—Ç–æ –∫–∞–∂–¥–æ–º—É –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é –≤—ã–¥–µ–ª—è–µ—Ç—Å—è 2 —è–¥—Ä–∞ –∏ 4 –ì–ë –ø–∞–º—è—Ç–∏, –∫–ª–∞—Å—Ç–µ—Ä–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –º–æ–∂–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å –¥–æ 8 –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –Ω–∞ –æ–¥–Ω–æ–º worker node.

**–†–∞—Å—á–µ—Ç —Ä–µ—Å—É—Ä—Å–æ–≤:**

–î–æ—Å—Ç—É–ø–Ω—ã–µ —è–¥—Ä–∞ –Ω–∞ worker node: 16

–Ø–¥—Ä–∞ –Ω–∞ –æ–¥–Ω–æ–≥–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è: 2

–î–æ—Å—Ç—É–ø–Ω–∞—è –ø–∞–º—è—Ç—å –Ω–∞ worker node: 64 –ì–ë

–ü–∞–º—è—Ç—å –Ω–∞ –æ–¥–Ω–æ–≥–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è: 4 –ì–ë

**–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –Ω–∞ –æ–¥–Ω–æ–º worker node:**

–Ø–¥—Ä–∞: 16 / 2 = 8 –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π

–ü–∞–º—è—Ç—å: 64 –ì–ë / 4 –ì–ë = 16 –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π

–ó–¥–µ—Å—å –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–º —Ñ–∞–∫—Ç–æ—Ä–æ–º —è–≤–ª—è–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —è–¥–µ—Ä, –ø–æ—ç—Ç–æ–º—É –Ω–∞ —ç—Ç–æ–º worker node –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –¥–æ 8 –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π.

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**

–†–µ—Å—É—Ä—Å—ã —É–∑–ª–∞: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω—ã –Ω–∞ –æ–¥–Ω–æ–º worker node, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏ (—è–¥—Ä–∞–º–∏ –∏ –ø–∞–º—è—Ç—å—é) –Ω–∞ —ç—Ç–æ–º —É–∑–ª–µ.

–ò–∑–æ–ª—è—Ü–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤: –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤—ã–¥–µ–ª—è—Ç—å —Ä–µ—Å—É—Ä—Å—ã —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∏ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—É—é –∏–∑–æ–ª—è—Ü–∏—é –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è.

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–ª–∞—Å—Ç–µ—Ä–∞: –ö–ª–∞—Å—Ç–µ—Ä–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –ø–æ —É–∑–ª–∞–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤.

**–ó–∞–º–µ—Ç–∫–∞**

- Driver –≤—Å–µ–≥–¥–∞ –æ–¥–∏–Ω –Ω–∞ –≤–µ—Å—å –∫–ª–∞—Å—Ç–µ—Ä.

- Worker nodes –≤—ã–ø–æ–ª–Ω—è—é—Ç –∑–∞–¥–∞—á–∏, –Ω–æ –æ–Ω–∏ –ø–æ–ª—É—á–∞—é—Ç –∫–æ–º–∞–Ω–¥—ã –æ—Ç –µ–¥–∏–Ω–æ–≥–æ Driver.

- Executors –Ω–∞ Worker nodes –≤—ã–ø–æ–ª–Ω—è—é—Ç —Å–≤–æ–∏ —á–∞—Å—Ç–∏ –∑–∞–¥–∞—á, –Ω–æ Driver —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

Driver —è–≤–ª—è–µ—Ç—Å—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π —Ç–æ—á–∫–æ–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –≤—Å–µ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞. –û–Ω:

- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–¥–∞—á–∏ Worker —É–∑–ª–∞–º.

- –°–ª–µ–¥–∏—Ç –∑–∞ –∏—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º.

- –ê–≥—Ä–µ–≥–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

Worker nodes –ø–æ–ª—É—á–∞—é—Ç –∑–∞–¥–∞—á–∏ –æ—Ç Driver –∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç –∏—Ö –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞, –Ω–æ –ø–æ –∑–∞–¥–∞–Ω–∏—è–º, —Å–ø—É—â–µ–Ω–Ω—ã–º –æ—Ç Driver.

## Workflow –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Spark

Workflow - –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —à–∞–≥–æ–≤ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏

**–ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è SparkContext**

```
from pyspark.sql import SparkSession

# –°–æ–∑–¥–∞–Ω–∏–µ SparkSession
spark = SparkSession.builder.appName("Spark Workflow Example").getOrCreate()

# –ü–æ–ª—É—á–µ–Ω–∏–µ SparkContext
sc = spark.sparkContext
```

-–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –Ω–∞–ø–∏—Å–∞–Ω–Ω–æ–µ –Ω–∞ Python, Scala, Java –∏–ª–∏ R, –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ.

-–í —ç—Ç–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç SparkSession (–∫–æ—Ç–æ—Ä—ã–π –≤–∫–ª—é—á–∞–µ—Ç SparkContext), –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—â–∏–π –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã Spark.

-–¢–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ SparkContext –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥—Ä–∞–π–≤–µ—Ä–æ–º (Driver)

**–ó–∞–ø—Ä–æ—Å —Ä–µ—Å—É—Ä—Å–æ–≤ —É –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤**

-–î—Ä–∞–π–≤–µ—Ä –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —É –∫–ª–∞—Å—Ç–µ—Ä–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, YARN, Mesos, Kubernetes –∏–ª–∏ Spark Standalone) —Ä–µ—Å—É—Ä—Å—ã –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏.

-–î—Ä–∞–π–≤–µ—Ä —Å–æ–æ–±—â–∞–µ—Ç –∫–ª–∞—Å—Ç–µ—Ä–Ω–æ–º—É –º–µ–Ω–µ–¥–∂–µ—Ä—É, —Å–∫–æ–ª—å–∫–æ —Ä–µ—Å—É—Ä—Å–æ–≤ –µ–º—É —Ç—Ä–µ–±—É–µ—Ç—Å—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π, –æ–±—ä–µ–º –ø–∞–º—è—Ç–∏ –∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω—ã–µ —è–¥—Ä–∞).

```
spark-submit \
  --master yarn \
  --deploy-mode cluster \
  --num-executors 10 \
  --executor-memory 4g \
  --executor-cores 2 \
  path/to/your_script.py
```

–≠–∫–≤–∏–≤–∞–ª–µ–Ω—Ç –≤ –∫–æ–¥–µ Python:

```
from pyspark.sql import SparkSession

spark = SparkSession.builder \
    .appName("MyApp") \
    .config("spark.master", "yarn") \
    .config("spark.submit.deployMode", "cluster") \
    .config("spark.executor.instances", "10") \
    .config("spark.executor.memory", "4g") \
    .config("spark.executor.cores", "2") \
    .getOrCreate()

# –ó–¥–µ—Å—å –ø–∏—à–µ–º –∫–æ–¥
df = spark.read.parquet("hdfs://path/to/data")
df.show()

spark.stop()
```

–ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞:
–ö–æ–º–∞–Ω–¥—É –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –≥–¥–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Hadoop/Spark, –æ–±—ã—á–Ω–æ —ç—Ç–æ:

```
bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ edge-—É–∑–ª—É
ssh data_engineer@hadoop-edge-01.prod.company.com

# 2. –ü–µ—Ä–µ–π—Ç–∏ –≤ —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd /home/data_engineer/my_spark_project

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Ç–µ—Ä–∞
hdfs dfs -ls /data/input

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å Spark-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
spark-submit \
  --master yarn \
  --deploy-mode cluster \
  --num-executors 10 \
  --executor-memory 4g \
  --executor-cores 2 \
  --name "My Data Processing Job" \
  data_processing.py

# 5. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
yarn application -list
```
              
**–ó–∞–ø—É—Å–∫ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º –∫–ª–∞—Å—Ç–µ—Ä–æ–≤**

-–ö–ª–∞—Å—Ç–µ—Ä–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–µ—Å—É—Ä—Å—ã –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å—ã –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π (executors) –Ω–∞ —Ä–∞–±–æ—á–∏—Ö —É–∑–ª–∞—Ö (worker nodes).

-–ö–∞–∂–¥—ã–π –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –∑–∞–ø—É—Å–∫–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–¥–∞—á–∏, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –¥—Ä–∞–π–≤–µ—Ä–æ–º.

**–ó–∞–ø—É—Å–∫ –∫–æ–¥–∞ Spark –¥—Ä–∞–π–≤–µ—Ä–æ–º**

-–î—Ä–∞–π–≤–µ—Ä –Ω–∞—á–∏–Ω–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ Spark, –∫–æ—Ç–æ—Ä—ã–π –≤–∫–ª—é—á–∞–µ—Ç —á—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π (transformations) –∏ –¥–µ–π—Å—Ç–≤–∏–π (actions).

-–î—Ä–∞–π–≤–µ—Ä —Ä–∞–∑–¥–µ–ª—è–µ—Ç –∑–∞–¥–∞—á–∏ –Ω–∞ —ç—Ç–∞–ø—ã (stages) –∏ –Ω–∞–∑–Ω–∞—á–∞–µ—Ç –∏—Ö –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è–º.

```
# –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
df = spark.read.csv("path/to/input.csv", header=True, inferSchema=True)

# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π
df_filtered = df.filter(df["age"] > 30)
df_grouped = df_filtered.groupBy("city").count()
```
                  
**–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è–º–∏ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥—Ä–∞–π–≤–µ—Ä—É**

-–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç –∑–∞–¥–∞–Ω–∏—è –æ—Ç –¥—Ä–∞–π–≤–µ—Ä–∞ –∏ –Ω–∞—á–∏–Ω–∞—é—Ç –∏—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.

-–ö–∞–∂–¥—ã–π –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –≤—ã–ø–æ–ª–Ω—è–µ—Ç —á–∞—Å—Ç—å —Ä–∞–±–æ—Ç—ã, —Ç–∞–∫–æ–π –∫–∞–∫ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –Ω–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥—Ä–∞–π–≤–µ—Ä—É.

```
# –î–µ–π—Å—Ç–≤–∏–µ, –∏–Ω–∏—Ü–∏–∏—Ä—É—é—â–µ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π
result = df_grouped.collect()
```
                  
**–û—Å—Ç–∞–Ω–æ–≤–∫–∞ SparkContext –∏ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤**

-–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–¥–∞—á, –¥—Ä–∞–π–≤–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç SparkContext.

-–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –∏ –æ—Å–≤–æ–±–æ–∂–¥–∞—é—Ç –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–µ –∏–º —Ä–µ—Å—É—Ä—Å—ã, –≤–æ–∑–≤—Ä–∞—â–∞—è –∏—Ö –æ–±—Ä–∞—Ç–Ω–æ –≤ –∫–ª–∞—Å—Ç–µ—Ä.

```
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ SparkSession –∏ SparkContext
spark.stop()
```

**Spark Workflow –∫—Ä–∞—Ç–∫–æ:**

üöó Driver-–ø—Ä–æ–≥—Ä–∞–º–º–∞ - –≤–∞—à Python-—Å–∫—Ä–∏–ø—Ç —Å SparkSession

üìã –ó–∞–ø—Ä–æ—Å —Ä–µ—Å—É—Ä—Å–æ–≤ - —á–µ—Ä–µ–∑ spark-submit –≥–æ–≤–æ—Ä–∏–º —Å–∫–æ–ª—å–∫–æ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π

üë• Cluster Manager (YARN) - –Ω–∞—Ö–æ–¥–∏—Ç —Å–≤–æ–±–æ–¥–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç Executors

üõ†Ô∏è Executors - —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö

üìä –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö - Spark –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥—Ä–æ–±–∏—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ —á–∞—Å—Ç–∏

‚ö° –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ - –∫–∞–∂–¥—ã–π Executor –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–≤–æ—é —á–∞—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

üì¶ –°–±–æ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ - Executors –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—Ä–∞—Ç–Ω–æ Driver

üßπ –û—á–∏—Å—Ç–∫–∞ - spark.stop() –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã

–ü—Ä–æ—â–µ: –í–∞—à –∫–æ–¥ ‚Üí Spark —Ä–∞–∑–±–∏–≤–∞–µ—Ç –Ω–∞ –∑–∞–¥–∞—á–∏ ‚Üí –ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–µ—Ä–≤–µ—Ä–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ ‚Üí –°–æ–±–∏—Ä–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã ‚Üí –û—Ç–¥–∞–µ—Ç –≤–∞–º.

**‚ö° –ß—Ç–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**

| –†–æ–ª—å | –í Spark | –í –∞–Ω–∞–ª–æ–≥–∏–∏ |
|------|---------|------------|
| Driver | –í–∞—à Python-—Å–∫—Ä–∏–ø—Ç | –ü—Ä–æ—Ä–∞–± |
| Cluster Manager | YARN/K8s/Mesos | –î–∏—Ä–µ–∫—Ç–æ—Ä –ø–æ –ø–µ—Ä—Å–æ–Ω–∞–ª—É |
| Executors | –ü—Ä–æ—Ü–µ—Å—Å—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö | –†–∞–±–æ—á–∏–µ –±—Ä–∏–≥–∞–¥—ã |
| Tasks | –ï–¥–∏–Ω–∏—Ü—ã —Ä–∞–±–æ—Ç—ã | –ó–∞–¥–∞–Ω–∏—è —Ä–∞–±–æ—á–∏–º |
| Data | RDD/DataFrame | –°—Ç—Ä–æ–π–º–∞—Ç–µ—Ä–∏–∞–ª—ã |

–ö–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç: –í—ã –ø–∏—à–µ—Ç–µ –∫–æ–¥ —Ç–∞–∫, –±—É–¥—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç–µ —Å –æ–¥–Ω–∏–º –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–º, –∞ Spark –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç —ç—Ç—É —Ä–∞–±–æ—Ç—É –Ω–∞ —Å–æ—Ç–Ω–∏ —Å–µ—Ä–≤–µ—Ä–æ–≤!

## RDD vs Dataset vs Dataframe

–•—Ä–∞–Ω–∏—Ç—å –æ–≥—Ä–æ–º–Ω—ã–π –º–∞—Å—Å–∏–≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (–±–æ–ª—å—à–∏–µ –¥–∞–Ω–Ω—ã–µ) –≤ —Å–ø–∏—Å–∫–µ –∏–ª–∏ –∫–æ—Ä—Ç–µ–∂–µ –∏–ª–∏ —Å–ª–æ–≤–∞—Ä–µ Python –∑–∞–Ω—è—Ç–∏–µ –Ω–µ –æ—á–µ–Ω—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ, –¥–∞ –∏ –Ω–µ–±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ–µ. –ü–æ—ç—Ç–æ–º—É –≤–≤–µ–¥–µ–º –≤ –Ω–∞—à –æ–±–æ—Ä–æ—Ç –µ—â–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä—É–∫—Ç—É—Ä, –ø—Ä–∏–º–µ–Ω–∏–º—ã—Ö —Ç–æ–ª—å–∫–æ –≤ —Ä–∞–º–∫–∞—Ö PySpark. –ó–¥–µ—Å—å –ø—Ä–∏–≤–æ–¥—è—Ç—Å—è —Ç—Ä–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, —Ö–æ—Ç—è –≤ PySpark –¥–æ—Å—Ç—É–ø–Ω—ã –±—É–¥—É—Ç —Ç–æ–ª—å–∫–æ 2 (RDD, Dataframe). –≠—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ dataset –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ Spark –ø–æ–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º Java –∏ Scala. 

**RDD** ‚Äì —ç—Ç–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã—Ö –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —É–∑–ª–∞–º –∫–ª–∞—Å—Ç–µ—Ä–∞, –Ω–∞–±–æ—Ä –æ–±—ä–µ–∫—Ç–æ–≤ Java –∏–ª–∏ Scala, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏—Ö –¥–∞–Ω–Ω—ã–µ. RDD —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∏ —Å –Ω–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–º–∏. –¢–∞–∫–∂–µ, –∫–∞–∫ DataFrame –∏ DataSet, RDD –Ω–µ –≤—ã–≤–æ–¥–∏—Ç —Å—Ö–µ–º—É –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Ç—Ä–µ–±—É–µ—Ç –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ–µ —É–∫–∞–∑–∞–Ω–∏—è.

<img width="756" height="326" alt="image" src="https://github.com/user-attachments/assets/9f6ab153-14df-4de6-8d8f-1bfa138ba0e4" />

**DataFrame** ‚Äì —ç—Ç–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –≤–∏–¥–µ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Ç–∞–±–ª–∏—Ü–µ –≤ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. DataFrame —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∏ –ø–æ–ª—É—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –æ—Ä–≥–∞–Ω–∏–∑—É—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º, –∫–∞–∫ –≤ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç Spark —É–ø—Ä–∞–≤–ª—è—Ç—å —Å—Ö–µ–º–æ–π –¥–∞–Ω–Ω—ã—Ö.

**DataSet**‚Äì —ç—Ç–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ API DataFrame, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–µ–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –æ–±—ä–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ RDD-API (—Å—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è, –ª—è–º–±–¥–∞-—Ñ—É–Ω–∫—Ü–∏–∏), –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ Catalyst –∏ –º–µ—Ö–∞–Ω–∏–∑–º —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–Ω–µ –∫—É—á–∏. DataSet —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏ –Ω–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—è –∏—Ö –≤ –≤–∏–¥–µ —Å—Ç—Ä–æ–∫–∏ JVM-–æ–±—ä–µ–∫—Ç–æ–≤ –∏–ª–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏. –î–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫ (encoder).

RDD, DataFrame –∏ DataSet –ø–æ-—Ä–∞–∑–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö :

- –≤ API RDD –ø—Ä–æ–µ–∫—Ü–∏–∏ —Å—Ö–µ–º—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —è–≤–Ω–æ, –ø–æ—ç—Ç–æ–º—É —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —Å—Ö–µ–º—É –¥–∞–Ω–Ω—ã—Ö –≤—Ä—É—á–Ω—É—é;

- –¥–∞—Ç–∞—Ñ—Ä–µ–π–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ö–µ–º—É –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–æ–≤ –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏—Ö –≤ –≤–∏–¥–µ —Ç–∞–±–ª–∏—Ü, –Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ –º–µ—Ç–∞-—Ö—Ä–∞–Ω–∏–ª–∏—â–µ Apache –ë–ª–∞–≥–æ–¥–∞—Ä—è —ç—Ç–æ–º—É –≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö SQL-–∫–ª–∏–µ–Ω—Ç–æ–≤ –∫ Apache Spark.

- –¥–∞—Ç–∞—Å–µ—Ç —Ç–∞–∫–∂–µ, –±–ª–∞–≥–æ–¥–∞—Ä—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–º—É –¥–≤–∏–∂–∫—É Spark SQL (engine) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏—Ç —Å—Ö–µ–º—É –¥–∞–Ω–Ω—ã—Ö.

–í Apache Spark —Å—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö (schema) –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö –∏ –∏—Ö —Ç–∏–ø—ã. –ü–æ–Ω–∏–º–∞–Ω–∏–µ —Å—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö –≤–∞–∂–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å RDD, DataFrame –∏ Dataset, –ø–æ—Å–∫–æ–ª—å–∫—É –∫–∞–∂–¥—ã–π –∏–∑ —ç—Ç–∏—Ö —Ç–∏–ø–æ–≤ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π –∏–º–µ–µ—Ç —Å–≤–æ–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏ –ø–æ–¥—Ö–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å—Ö–µ–º–æ–π.

**RDD (Resilient Distributed Dataset)**

–°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö:

- –í RDD —Å—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—è–≤–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –æ–±—ä–µ–∫—Ç–æ–≤, —Ö—Ä–∞–Ω—è—â–∏—Ö—Å—è –≤ RDD.

- RDD —è–≤–ª—è–µ—Ç—Å—è —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏–µ–π, –≥–¥–µ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—ä–µ–∫—Ç–æ–º –ª—é–±–æ–≥–æ —Ç–∏–ø–∞, –Ω–æ Spark –Ω–µ —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

```
from pyspark import SparkContext

sc = SparkContext("local", "RDD Example")
data = [("Alice", 1), ("Bob", 2), ("Cathy", 3)]
rdd = sc.parallelize(data)

# –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—è–≤–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –∫–æ—Ä—Ç–µ–∂–µ–π
print(rdd.collect())  # [('Alice', 1), ('Bob', 2), ('Cathy', 3)]
```
                  
**DataFrame**

–°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö:

- –í DataFrame —Å—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö —è–≤–Ω–∞—è –∏ –≤–∫–ª—é—á–∞–µ—Ç –∏–º–µ–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö.

- –°—Ö–µ–º–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ DataFrame –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, CSV, JSON) –∏–ª–∏ —è–≤–Ω–æ –∑–∞–¥–∞–Ω–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ DataFrame.

```
from pyspark.sql import SparkSession
from pyspark.sql.types import StructType, StructField, StringType, IntegerType

spark = SparkSession.builder.appName("DataFrame Example").getOrCreate()
data = [("Alice", 1), ("Bob", 2), ("Cathy", 3)]

# –Ø–≤–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ö–µ–º—ã
schema = StructType([
    StructField("Name", StringType(), True),
    StructField("Value", IntegerType(), True)
])

# –°–æ–∑–¥–∞–Ω–∏–µ DataFrame —Å —è–≤–Ω–æ–π —Å—Ö–µ–º–æ–π
df = spark.createDataFrame(data, schema)
df.printSchema()

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ö–µ–º—ã –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ CSV
df_auto = spark.read.csv("/path/to/csv/file", header=True, inferSchema=True)
df_auto.printSchema()
```
                  
**Dataset (–¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –≤ Scala –∏ Java)**

–°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö:

- –í Dataset —Å—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö —è–≤–Ω–∞—è –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ (–∫–ª–∞—Å—Å–æ–≤), —Ö—Ä–∞–Ω—è—â–∏—Ö—Å—è –≤ Dataset.

- Dataset —Å–æ—á–µ—Ç–∞–µ—Ç –≤ —Å–µ–±–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ RDD (—Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API) –∏ DataFrame (—è–≤–Ω–∞—è —Å—Ö–µ–º–∞ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è).

```
import org.apache.spark.sql.SparkSession
import org.apache.spark.sql.types._

val spark = SparkSession.builder.appName("Dataset Example").getOrCreate()
import spark.implicits._

case class Person(name: String, age: Int)
val data = Seq(Person("Alice", 1), Person("Bob", 2), Person("Cathy", 3))
val ds = data.toDS()

// –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –∫–ª–∞—Å—Å–∞ Person
ds.printSchema()
```

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ RDD, DataFrame –∏ Dataset –ø–æ —Å—Ö–µ–º–µ –¥–∞–Ω–Ω—ã—Ö**

**RDD:**

- –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—è–≤–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –æ–±—ä–µ–∫—Ç–æ–≤.

- –ù–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —è–≤–Ω–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è —Å—Ö–µ–º—ã.

- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∏–ª–∏ —Å–ª–∞–±–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

**DataFrame:**

- –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö —è–≤–Ω–∞—è –∏ –≤–∫–ª—é—á–∞–µ—Ç –∏–º–µ–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö.

- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ö–µ–º—ã –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.

- –£–¥–æ–±–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–æ—â–Ω—ã–π API –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —É—Ä–æ–≤–Ω–µ SQL.

**Dataset (Scala/Java):**

- –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö —è–≤–Ω–∞—è –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ (–∫–ª–∞—Å—Å–æ–≤).

- –°–æ—á–µ—Ç–∞–µ—Ç –≤ —Å–µ–±–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ RDD (—Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API) –∏ DataFrame (—è–≤–Ω–∞—è —Å—Ö–µ–º–∞ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è).

- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫—É—é —Ç–∏–ø–∏–∑–∞—Ü–∏—é –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ Catalyst Optimizer. 

## –õ–µ–Ω–∏–≤—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è

–í Apache Spark –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –ª–µ–Ω–∏–≤—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π (lazy evaluation), –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π (transformations) –∏ –¥–µ–π—Å—Ç–≤–∏–π (actions) –∏–≥—Ä–∞—é—Ç –∫–ª—é—á–µ–≤—É—é —Ä–æ–ª—å –≤ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π. –†–∞–∑–±–µ—Ä–µ–º—Å—è, —á—Ç–æ –æ–∑–Ω–∞—á–∞—é—Ç —ç—Ç–∏ —Ç–µ—Ä–º–∏–Ω—ã –∏ –∫–∞–∫ –æ–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ Spark.

**1. –õ–µ–Ω–∏–≤—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è (Lazy Evaluation)**

**–û–ø–∏—Å–∞–Ω–∏–µ:**

–õ–µ–Ω–∏–≤—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –æ–∑–Ω–∞—á–∞—é—Ç, —á—Ç–æ Spark –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å—Ä–∞–∑—É –ø—Ä–∏ –≤—ã–∑–æ–≤–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ Spark –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –Ω–µ –≤—Å—Ç—Ä–µ—Ç–∏—Ç –¥–µ–π—Å—Ç–≤–∏–µ, —Ç—Ä–µ–±—É—é—â–µ–µ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω–µ—á–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.
–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç Spark –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, –æ–±—ä–µ–¥–∏–Ω—è—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π –≤ –æ–¥–Ω–æ –∏ –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞ (I/O).

**–ü–ª—é—Å—ã:**

üî∏ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: Spark –º–æ–∂–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, —É–º–µ–Ω—å—à–∏–≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –æ–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö, –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã—Ö –º–µ–∂–¥—É —É–∑–ª–∞–º–∏.

üî∏ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: –ü–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –Ω–µ–Ω—É–∂–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, —Ç–∞–∫ –∫–∞–∫ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

**–ú–∏–Ω—É—Å—ã:**

‚ö†Ô∏è –°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏: –¢–∞–∫ –∫–∞–∫ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ, —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–ª–æ–∂–Ω–µ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –∏ –ø—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –û—à–∏–±–∫–∏ –º–æ–≥—É—Ç –ø—Ä–æ—è–≤–∏—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –¥–µ–π—Å—Ç–≤–∏—è (action), —á—Ç–æ –∑–∞—Ç—Ä—É–¥–Ω—è–µ—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É.

‚ö†Ô∏è –ó–∞–¥–µ—Ä–∂–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: –ü–æ—Å–∫–æ–ª—å–∫—É –≤—Å–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –æ—Ç–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è –¥–æ –º–æ–º–µ–Ω—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è, –≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–º, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ —Ü–µ–ø–æ—á–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π –¥–ª–∏–Ω–Ω–∞—è. –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º –∑–∞–¥–µ—Ä–∂–∫–∞–º –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –¥–µ–π—Å—Ç–≤–∏—è.

‚ö†Ô∏è –ü–∞–º—è—Ç—å –∏ —Ä–µ—Å—É—Ä—Å—ã: –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—é –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –ø–∞–º—è—Ç–∏. –≠—Ç–æ –º–æ–∂–µ—Ç —É–≤–µ–ª–∏—á–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –ø–∞–º—è—Ç—å –∏ —Ä–µ—Å—É—Ä—Å—ã –∫–ª–∞—Å—Ç–µ—Ä–∞, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Å–±–æ—è–º –∏–ª–∏ —Å–Ω–∏–∂–µ–Ω–∏—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

**2. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è (Transformations)**

**–û–ø–∏—Å–∞–Ω–∏–µ**

–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Å–æ–∑–¥–∞—é—Ç –Ω–æ–≤—ã–π RDD –∏–ª–∏ DataFrame –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ, –Ω–æ –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ. –û–Ω–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –Ω–æ–≤—ã–π RDD –∏–ª–∏ DataFrame, –∫–æ—Ç–æ—Ä—ã–π –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏.
–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —è–≤–ª—è—é—Ç—Å—è –ª–µ–Ω–∏–≤—ã–º–∏ –∏ —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç, –∫–∞–∫ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ, –±–µ–∑ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π.

**–ü—Ä–∏–º–µ—Ä—ã:**

`map()` ‚Äî –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –∫ –∫–∞–∂–¥–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É RDD –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤—ã–π RDD.

`filter()` ‚Äî –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤—ã–π RDD, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Ç–æ–ª—å–∫–æ —Ç–µ —ç–ª–µ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—Ç —É—Å–ª–æ–≤–∏—é.

`flatMap()` ‚Äî –ü–æ—Ö–æ–∂ –Ω–∞ map, –Ω–æ –∫–∞–∂–¥–∞—è –≤—Ö–æ–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –≤—ã—Ö–æ–¥–Ω—ã–º–∏.

`distinct()` - –£–±–∏—Ä–∞–µ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ RDD. 

`union()` -  –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –¥–≤–∞ RDD –≤ –æ–¥–∏–Ω.

```
from pyspark import SparkContext

sc = SparkContext("local", "Transformations Example")
data = [1, 2, 3, 4, 5]
rdd = sc.parallelize(data)

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è map
squared_rdd = rdd.map(lambda x: x * x)
```

**3. –î–µ–π—Å—Ç–≤–∏—è (Actions)**

**–û–ø–∏—Å–∞–Ω–∏–µ:**

–î–µ–π—Å—Ç–≤–∏—è –∏–Ω–∏—Ü–∏–∏—Ä—É—é—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, –æ–ø–∏—Å–∞–Ω–Ω—ã—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è–º–∏, –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –¥—Ä–∞–π–≤–µ—Ä –∏–ª–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç –µ–≥–æ –≤–æ –≤–Ω–µ—à–Ω–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫.
–î–µ–π—Å—Ç–≤–∏—è –∑–∞—Å—Ç–∞–≤–ª—è—é—Ç Spark –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Å–µ –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.

**–¢–∏–ø—ã –¥–µ–π—Å—Ç–≤–∏–π:**

`collect`: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã RDD –∏–ª–∏ DataFrame –≤ –≤–∏–¥–µ —Å–ø–∏—Å–∫–∞ –Ω–∞ –¥—Ä–∞–π–≤–µ—Ä.

`count`: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ RDD –∏–ª–∏ DataFrame.

`first`: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç RDD –∏–ª–∏ DataFrame.

`take`: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–≤—ã–µ n —ç–ª–µ–º–µ–Ω—Ç–æ–≤ RDD –∏–ª–∏ DataFrame.

`reduce`: –ü—Ä–∏–º–µ–Ω—è–µ—Ç –∫–æ–º–º—É—Ç–∞—Ç–∏–≤–Ω—É—é –∏ –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—É—é –±–∏–Ω–∞—Ä–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤.

`saveAsTextFile`: –°–æ—Ö—Ä–∞–Ω—è–µ—Ç RDD –∫–∞–∫ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ.

```
# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è collect –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –∏ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
result = squared_rdd.collect()
print(result)  # [1, 4, 9, 16, 25]
```

## –§–æ—Ä–º–∞—Ç—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

**–†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —Å—Ç—Ä–æ—á–Ω—ã–º –∏ –∫–æ–ª–æ–Ω–æ—á–Ω—ã–º —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º**

–ü—Ä–∏–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã:

| id | name  | age | city   |
| -- | ----- | --- | ------ |
| 1  | Anna  | 25  | Moscow |
| 2  | Ivan  | 30  | London |
| 3  | Maria | 22  | Berlin |

**–°—Ç—Ä–æ—á–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ (Row-based storage)** - –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –ø–æ—Å—Ç—Ä–æ—á–Ω–æ, —Ç–æ –µ—Å—Ç—å –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø–∏—Å–∞–Ω—ã —Ä—è–¥–æ–º –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º –≤ –ø–∞–º—è—Ç–∏ –∏–ª–∏ –Ω–∞ –¥–∏—Å–∫–µ.

–í –ø–∞–º—è—Ç–∏ –∏–ª–∏ –Ω–∞ –¥–∏—Å–∫–µ —ç—Ç–æ –±—É–¥–µ—Ç –∑–∞–ø–∏—Å–∞–Ω–æ –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:

```
[1, Anna, 25, Moscow]
[2, Ivan, 30, London]
[3, Maria, 22, Berlin]
```

–ü–ª—é—Å: –ë—ã—Å—Ç—Ä–æ —á–∏—Ç–∞—Ç—å –≤—Å—é —Å—Ç—Ä–æ–∫—É —Ü–µ–ª–∏–∫–æ–º. –ë—ã—Å—Ç—Ä–æ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—Å—Ç–∞–≤–∫–∏, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏. –û—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è OLTP-—Å–∏—Å—Ç–µ–º (–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –±–∞–∑—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä PostgreSQL, MySQL).

üìò –ü—Ä–∏–º–µ—Ä: `SELECT * FROM users WHERE id = 1;` –ó–¥–µ—Å—å –≤–∞–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –ø–æ–ª—É—á–∏—Ç—å –≤—Å—é —Å—Ç—Ä–æ–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø–æ—ç—Ç–æ–º—É —Å—Ç—Ä–æ—á–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ.

–ú–∏–Ω—É—Å: –ú–µ–¥–ª–µ–Ω–Ω–æ —á–∏—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Å—Ç–æ–ª–±–µ—Ü (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—Å–µ –≤–æ–∑—Ä–∞—Å—Ç—ã), —Ç.–∫. –Ω—É–∂–Ω–æ –ø—Ä–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ. –ü—Ä–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ (–∞–≥—Ä–µ–≥–∞—Ü–∏—è—Ö, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –∫–æ–ª–æ–Ω–∫–∞–º) –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–∞–¥–∞–µ—Ç.

**–ö–æ–ª–æ–Ω–æ—á–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ (Column-based storage)** - –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –ø–æ –∫–æ–ª–æ–Ω–∫–∞–º, –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –∏–¥—É—Ç –ø–æ–¥—Ä—è–¥.

–í –ø–∞–º—è—Ç–∏ –∏–ª–∏ –Ω–∞ –¥–∏—Å–∫–µ —ç—Ç–æ –±—É–¥–µ—Ç –∑–∞–ø–∏—Å–∞–Ω–æ –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:

```
id:   [1, 2, 3]
name: [Anna, Ivan, Maria]
age:  [25, 30, 22]
city: [Moscow, London, Berlin]
```

–ü–ª—é—Å: –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –∏ —á–∏—Ç–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç–æ–ª–±—Ü–æ–≤ (—Ç.–∫. —á–∏—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–π —Å—Ç–æ–ª–±–µ—Ü). –õ—É—á—à–µ–µ —Å–∂–∞—Ç–∏–µ (–ø–æ—Å–∫–æ–ª—å–∫—É –¥–∞–Ω–Ω—ã–µ –≤ –æ–¥–Ω–æ–º —Å—Ç–æ–ª–±—Ü–µ –æ–¥–Ω–æ—Ç–∏–ø–Ω—ã).
–û—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è OLAP-—Å–∏—Å—Ç–µ–º (–∞–Ω–∞–ª–∏—Ç–∏–∫–∞, –æ—Ç—á—ë—Ç—ã, –≤–∏—Ç—Ä–∏–Ω—ã –¥–∞–Ω–Ω—ã—Ö).

üìò –ü—Ä–∏–º–µ—Ä: `SELECT AVG(age) FROM users WHERE city = 'Moscow';` –ó–¥–µ—Å—å —á–∏—Ç–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–ª–æ–Ω–∫–∏ age –∏ city, –ø–æ—ç—Ç–æ–º—É –∫–æ–ª–æ–Ω–æ—á–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ –∏ —ç–∫–æ–Ω–æ–º–Ω–µ–µ –ø–æ –ø–∞–º—è—Ç–∏.

–ú–∏–Ω—É—Å: –ú–µ–¥–ª–µ–Ω–Ω–æ —á–∏—Ç–∞—Ç—å/–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –æ–¥–Ω—É —Ü–µ–ª—É—é —Å—Ç—Ä–æ–∫—É. –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–∏ —á–∞—Å—Ç—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö –∏ –≤—Å—Ç–∞–≤–∫–∞—Ö ‚Äî –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –±–ª–æ–∫–∏ –∫–æ–ª–æ–Ω–æ–∫. –ù–µ—É–¥–æ–±–Ω–æ –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏ –ø–æ—Ç–æ–∫–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º.
